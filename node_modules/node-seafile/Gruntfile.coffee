module.exports = (grunt) ->
	grunt.loadNpmTasks 'grunt-contrib-coffee'
	grunt.loadNpmTasks 'grunt-contrib-watch'
	grunt.loadNpmTasks 'grunt-sync'

	grunt.registerTask 'default', ['coffee']

	config =
		pkg: grunt.file.readJSON 'package.json'
		coffee:
			glob_to_multiple:
				expand: true
				flatten: false
				cwd: 'src/'
				src: ['**/*.coffee'],
				dest: 'dist/'
				ext: '.js'
		sync:
			copy:
				files: [
					cwd: 'src'
					src: ['**/*', '!**/*.coffee', '!**/*.slm']
					dest: 'dist/'
				]
				updateAndDelete: true
		watch:
			coffeescript:
				files: ['src/**/*.coffee']
				tasks: ['sync', 'coffee']
				options:
					spawn: true
					atBegin: true
	grunt.initConfig config
